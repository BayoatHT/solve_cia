######################################################################################################################
#   CORE IMPORTS
# ---------------------------------------------------------------------------------------------------------------------
import os
import re
import json
import logging
# --------------------------------------------------------------------------------------------------
# NOTE: "Air pollutants"
from proj_004_cia.c_04_environment.helper.utils.parse_air_pollutants import parse_air_pollutants
# --------------------------------------------------------------------------------------------------
# -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
# NOTE: "Climate"
from proj_004_cia.c_04_environment.helper.utils.parse_climate import parse_climate
# --------------------------------------------------------------------------------------------------
# -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
# NOTE: "Environment - current issues"
from proj_004_cia.c_04_environment.helper.utils.parse_env_current_issues import parse_env_current_issues
# --------------------------------------------------------------------------------------------------
# -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
# NOTE: "Environment - international agreements"
from proj_004_cia.c_04_environment.helper.utils.parse_env_international_agreements import parse_env_international_agreements
# --------------------------------------------------------------------------------------------------
# -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
# NOTE: "Food insecurity"
from proj_004_cia.c_04_environment.helper.utils.parse_food_insecurity import parse_food_insecurity
# --------------------------------------------------------------------------------------------------
# -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
# NOTE: "Geoparks"
from proj_004_cia.c_04_environment.helper.utils.parse_geoparks import parse_geoparks
# --------------------------------------------------------------------------------------------------
# -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
# NOTE: "Land use"
from proj_004_cia.c_04_environment.helper.utils.parse_land_use import parse_land_use
# --------------------------------------------------------------------------------------------------
# -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
# NOTE: "Major aquifers"
from proj_004_cia.c_04_environment.helper.utils.parse_major_aquifers import parse_major_aquifers
# --------------------------------------------------------------------------------------------------
# -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
# NOTE: "Major lakes (area sq km)"
from proj_004_cia.c_04_environment.helper.utils.parse_major_lakes import parse_major_lakes
# --------------------------------------------------------------------------------------------------
# -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
# NOTE: "Major rivers (by length in km)"
from proj_004_cia.c_04_environment.helper.utils.parse_major_rivers import parse_major_rivers
# --------------------------------------------------------------------------------------------------
# -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
# NOTE: "Major watersheds (area sq km)"
from proj_004_cia.c_04_environment.helper.utils.parse_major_watersheds import parse_major_watersheds
# --------------------------------------------------------------------------------------------------
# -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
# NOTE: "Revenue from coal"
from proj_004_cia.c_04_environment.helper.utils.parse_revenue_from_coal import parse_revenue_from_coal
# --------------------------------------------------------------------------------------------------
# -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
# NOTE: "Revenue from forest resources"
from proj_004_cia.c_04_environment.helper.utils.parse_revenue_from_forest import parse_revenue_from_forest
# --------------------------------------------------------------------------------------------------
# -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
# NOTE: "Total renewable water resources"
from proj_004_cia.c_04_environment.helper.utils.parse_total_renewable_water import parse_total_renewable_water
# --------------------------------------------------------------------------------------------------
# -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
# NOTE: "Total water withdrawal"
from proj_004_cia.c_04_environment.helper.utils.parse_total_water_withdrawal import parse_total_water_withdrawal
# --------------------------------------------------------------------------------------------------
# -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
# NOTE: "Urbanization"
from proj_004_cia.c_04_environment.helper.utils.parse_urbanization import parse_urbanization
# --------------------------------------------------------------------------------------------------
# -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
# NOTE: "Waste and recycling"
from proj_004_cia.c_04_environment.helper.utils.parse_waste_and_recycling import parse_waste_and_recycling
# --------------------------------------------------------------------------------------------------
# -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
# NOTE: "World biomes"
from proj_004_cia.c_04_environment.helper.utils.parse_world_biomes import parse_world_biomes
# --------------------------------------------------------------------------------------------------


# //////////////////////////////////////////////////////////////////////////////////////////////////


def get_environment(data=None, info=None, iso3Code=None):

    # 0
    # //////////////////////////////////////////////////////////////////////////////////////////////////
    # NOTE: ENVIRONMENT DATA
    # --------------------------------------------------------------------------------------------------
    env_data = data.get("Environment", {})
    # //////////////////////////////////////////////////////////////////////////////////////////////////

    # 1
    # //////////////////////////////////////////////////////////////////////////////////////////////////
    # NOTE: 1 >>> 'Air pollutants'
    # --------------------------------------------------------------------------------------------------
    air_pollutants_data = env_data.get("Air pollutants", {})
    # --------------------------------------------------------------------------------------------------

    if info == 'air_pollutants':
        return parse_air_pollutants(
            air_pollutants_data
        )

    # 2
    # //////////////////////////////////////////////////////////////////////////////////////////////////
    # NOTE: 2 >>> 'Climate'
    # --------------------------------------------------------------------------------------------------
    climate_data = env_data.get("Climate", {})
    # --------------------------------------------------------------------------------------------------

    if info == 'climate':
        return parse_climate(
            climate_data
        )
    # 3
    # //////////////////////////////////////////////////////////////////////////////////////////////////
    # NOTE: 3 >>> 'Environment - current issues'
    # --------------------------------------------------------------------------------------------------
    environment_current_issues_data = env_data.get(
        "Environment - current issues", {})
    # --------------------------------------------------------------------------------------------------

    if info == 'env_current_issues':
        return parse_env_current_issues(
            environment_current_issues_data
        )

    # 4
    # //////////////////////////////////////////////////////////////////////////////////////////////////
    # NOTE: 4 >>> 'Environment - international agreements'
    # --------------------------------------------------------------------------------------------------
    environment_international_agreements_data = env_data.get(
        "Environment - international agreements", {})
    # --------------------------------------------------------------------------------------------------

    if info == 'env_international_agreements':
        return parse_env_international_agreements(
            environment_international_agreements_data
        )
    # 5
    # //////////////////////////////////////////////////////////////////////////////////////////////////
    # NOTE: 5 >>> 'Food insecurity'
    # --------------------------------------------------------------------------------------------------
    food_insecurity_data = env_data.get("Food insecurity", {})
    # --------------------------------------------------------------------------------------------------

    if info == 'food_insecurity':
        return parse_food_insecurity(
            food_insecurity_data
        )
    # 6
    # //////////////////////////////////////////////////////////////////////////////////////////////////
    # NOTE: 6 >>> 'Geoparks'
    # --------------------------------------------------------------------------------------------------
    geoparks_data = env_data.get("Geoparks", {})
    # --------------------------------------------------------------------------------------------------

    if info == 'geoparks':
        return parse_geoparks(
            geoparks_data
        )
    # 7
    # //////////////////////////////////////////////////////////////////////////////////////////////////
    # NOTE: 7 >>> 'Land use'
    # --------------------------------------------------------------------------------------------------
    land_use_data = env_data.get("Land use", {})
    # --------------------------------------------------------------------------------------------------

    if info == 'land_use':
        return parse_land_use(
            land_use_data
        )
    # 8
    # //////////////////////////////////////////////////////////////////////////////////////////////////
    # NOTE: 8 >>> 'Major aquifers'
    # --------------------------------------------------------------------------------------------------
    major_aquifers_data = env_data.get("Major aquifers", {})
    # --------------------------------------------------------------------------------------------------

    if info == 'major_aquifers':
        return parse_major_aquifers(
            major_aquifers_data
        )
    # 9
    # //////////////////////////////////////////////////////////////////////////////////////////////////
    # NOTE: 9 >>> 'Major lakes (area sq km)'
    # --------------------------------------------------------------------------------------------------
    major_lakes_data = env_data.get("Major lakes (area sq km)", {})
    # --------------------------------------------------------------------------------------------------
    if info == 'major_lakes':
        return parse_major_lakes(
            major_lakes_data
        )

    # 10
    # //////////////////////////////////////////////////////////////////////////////////////////////////
    # NOTE: 10 >>> 'Major rivers (by length in km)'
    # --------------------------------------------------------------------------------------------------
    major_rivers_data = env_data.get("Major rivers (by length in km)", {})
    # --------------------------------------------------------------------------------------------------
    if info == 'major_rivers':
        return parse_major_rivers(
            major_rivers_data
        )

    # 11
    # //////////////////////////////////////////////////////////////////////////////////////////////////
    # NOTE: 11 >>> 'Major watersheds (area sq km)'
    # --------------------------------------------------------------------------------------------------
    major_watersheds_data = env_data.get("Major watersheds (area sq km)", {})
    # --------------------------------------------------------------------------------------------------

    if info == 'major_watersheds':
        return parse_major_watersheds(
            major_watersheds_data
        )

    # 12
    # //////////////////////////////////////////////////////////////////////////////////////////////////
    # NOTE: 12 >>> 'Revenue from coal'
    # --------------------------------------------------------------------------------------------------
    revenue_coal_data = env_data.get("Revenue from coal", {})
    # --------------------------------------------------------------------------------------------------

    if info == 'revenue_from_coal':
        return parse_revenue_from_coal(
            revenue_coal_data
        )
    # 13
    # //////////////////////////////////////////////////////////////////////////////////////////////////
    # NOTE: 13 >>> 'Revenue from forest resources'
    # --------------------------------------------------------------------------------------------------
    revenue_forest_resources_data = env_data.get(
        "Revenue from forest resources", {})
    # --------------------------------------------------------------------------------------------------
    if info == 'revenue_from_forest':
        return parse_revenue_from_forest(
            revenue_forest_resources_data
        )

    # 14
    # //////////////////////////////////////////////////////////////////////////////////////////////////
    # NOTE: 14 >>> 'Total renewable water resources'
    # --------------------------------------------------------------------------------------------------
    renewable_water_resources_data = env_data.get(
        "Total renewable water resources", {})
    # --------------------------------------------------------------------------------------------------
    if info == 'total_renewable_water':
        return parse_total_renewable_water(
            renewable_water_resources_data
        )

    # 15
    # //////////////////////////////////////////////////////////////////////////////////////////////////
    # NOTE: 15 >>> 'Total water withdrawal'
    # --------------------------------------------------------------------------------------------------
    water_withdrawal_data = env_data.get("Total water withdrawal", {})
    # --------------------------------------------------------------------------------------------------

    if info == 'total_water_withdrawal':
        return parse_total_water_withdrawal(
            water_withdrawal_data
        )
    # 16
    # //////////////////////////////////////////////////////////////////////////////////////////////////
    # NOTE: 16 >>> 'Urbanization'
    # --------------------------------------------------------------------------------------------------
    urbanization_data = env_data.get("Urbanization", {})
    # --------------------------------------------------------------------------------------------------

    if info == 'urbanization':
        return parse_urbanization(
            urbanization_data
        )
    # 17
    # //////////////////////////////////////////////////////////////////////////////////////////////////
    # NOTE: 17 >>> 'Waste and recycling'
    # --------------------------------------------------------------------------------------------------
    waste_recycling_data = env_data.get("Waste and recycling", {})
    # --------------------------------------------------------------------------------------------------

    if info == 'waste_and_recycling':
        return parse_waste_and_recycling(
            waste_recycling_data
        )
    # 18
    # //////////////////////////////////////////////////////////////////////////////////////////////////
    # NOTE: 18 >>> 'World biomes'
    # --------------------------------------------------------------------------------------------------
    world_biomes_data = env_data.get("World biomes", {})
    # --------------------------------------------------------------------------------------------------
    if info == 'world_biomes':
        return parse_world_biomes(
            world_biomes_data
        )


######################################################################################################################
#   TEST FUNCTION
######################################################################################################################
if __name__ == '__main__':
    # ---------------------------------------------------------------------------------------------------------------------------------
    info = 'pass'
    # ---------------------------------------------------------------------------------------------------------------------------------
    country = "USA"
    # ----------------------------------------------------------------------------------------------------------------------------------
    json_folder = f'C:\Users\bayoa\impact_projects\claude_solve_cia\proj_004_cia/_raw_data'
    if country == "USA":
        region_folder = f'north-america'
        cia_code = 'us'
    elif country == "FRA":
        region_folder = f'europe'
        cia_code = 'fr'
    elif country == "WLD":
        region_folder = f'world'
        cia_code = 'xx'
    file_path = os.path.join(json_folder, region_folder, f'{cia_code}.json')
    # --------------------------------------------------------------------------------------------------
    with open(file_path, 'r', encoding='utf-8') as country_file:
        data = json.load(country_file)
    # --------------------------------------------------------------------------------------------------
    iso3Code = country
    # --------------------------------------------------------------------------------------------------
    from pprint import pprint
    pprint(
        get_environment(
            data=data,
            info=info,
            iso3Code=iso3Code
        )
    )
